<html>
	<head>
		<title>Admin View</title>
		<link rel="stylesheet" href="css/bootstrap.min.css"/>
        <link rel="stylesheet" href="css/bootstrap-theme.css" />
        <link rel="stylesheet" href="css/style.css" />
		<script src="js/jquery.js"></script>
		<script src="js/bootstrap.min.js" type="text/javascript"></script>
		<script src="js/script.js"></script>
	</head>
	<body>
		<div id="top">
			<span id="logo">Pay Roll Manager</span>
			<button type="button" class="btn btn-primary dropdown-toggle menu" data-toggle="dropdown">
                    <span id="username">user</span> <span class="caret"></span>
                </button>
                <ul class="dropdown-menu menu" role="menu">
                    <li><a href="#">Profile</a></li>
                    <li><a href="#">Edit Details</a></li>
                    <li id="signOut"><a href="#">Sign out</a></li>
                </ul>
		</div>
		<div id="test"></div>
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-3 col-md-3 col-sm-3" id="panel">
					<br>
					<div class="panel panel-primary">
  						<!-- Default panel contents -->
 							 <div class="panel-heading " id="testHead"><b>Company List</b></div>
  					
					<div class="list-group" id="listTest" >
  						<button type="button" class="list-group-item" onclick="loadCompany()">Loading Comany</button>
					</div></div>
					<button type="button" id="btnNew" class="btn btn-info"  data-toggle="modal" data-target="#myModal">Create New Company</button>
				</div>
				<div class="col-lg-9 col-md-9 col-sm-3">
					&nbsp;<h1>Company 1</h1>&nbsp;
					<ul class="nav nav-tabs">
  						<li role="presentation" class="active" id="generalTab" section="generalSection"><a href="#">General</a></li>
  						<li role="presentation" id="addTab" section="addSection"><a href="#">Add Employees</a></li>
  						<li role="presentation" id="viewTab" section="viewSection"><a href="#">View Employee</a></li>
						<li role="presentation" id="payRollTab" section="payRollSection"><a href="#">PayRoll</a></li>
					</ul>
					<div id="generalSection" class="section"><br><span id="settings" class="glyphicon glyphicon-cog"></span>
						<!--p>Number of Employess : 121</p>
						<p>Date Of Next Payment : 1 Oct 2016</p-->
						<table id="generalTable" class="table table-bordered">
						</table>
					</div>
					<div id="addSection"  class="section"><br>
						<!--div class="alert alert-danger" role="alert">
							<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
							<span class="sr-only">Error:</span>
								Please Enter the feilds for employee first
						</div>
						<button id="btnCreateInAddSection" class="btn btn-warning">Create Feilds</button-->
						<div class="panel panel-default">
				  			<div class="panel-heading">Add Employee <span class="glyphicon glyphicon-plus add" id="addNewEmpIcon"></span> </div>
							<table class="table" id="tableAddEmp">
							</table>
                            <button class="btn btn-default" id="btnAddNewEmpDone">Done</button>
						</div>
					</div>
					<div id="viewSection" class="section"><br>
						<div class="panel panel-default">
				  			<div class="panel-heading">Employees <span class="glyphicon glyphicon-minus add" id="deleteEmpIcon"></span></div>
								<table class="table table-striped" id="empTable">
									<thead>
								      		<tr>
												<th>sno</th>
												<th>Name</th>
												<th>Father Name</th>
												<th>DOB</th>
												<th>DOJ</th>
												<th>Designation</th>
												<th>Qualification</th>
								      		</tr>
								   	</thead>
								   
								  	<tbody>
								      		<tr>
												<td>1</td>
												<td>Ram</td>
												<td>Raj</td>
												<td>DD-MM-YYYY</td>
												<td>DD-MM-YYYY</td>
												<td>Assistant Director</td>
												<td>BBA</td>
								      		</tr>
								      
								      		<tr>
												<td>2</td>
												<td>Guna</td>
												<td>Lokesh</td>
												<td>DD-MM-YYYY</td>
												<td>DD-MM-YYYY</td>
												<td>Director</td>
												<td>MBA</td>
								      		</tr>
								      		<tr>
												<td>3</td>
												<td>Bharath</td>
												<td>rehan</td>
												<td>DD-MM-YYYY</td>
												<td>DD-MM-YYYY</td>
												<td>Accountant</td>
												<td>MCOM</td>
								      		</tr>
								      		<tr>
												<td>1</td>
												<td>RAM</td>
												<td>RAJ</td>
												<td>DD-MM-YYYY</td>
												<td>DD-MM-YYYY</td>
												<td>Assistant Director</td>
												<td>BBA</td>
								      		</tr>
								      		<tr>
												<td>5</td>
												<td>bilal</td>
												<td>rasique</td>
												<td>DD-MM-YYYY</td>
												<td>DD-MM-YYYY</td>
												<td>Sales</td>
												<td>BBA</td>
								      		</tr>
								   	</tbody>
  								</table>
							</div>
					</div>
					<div id="payRollSection" class="section">
						<div class="panel panel-default">
							<div class="panel-heading">PayRoll</div>
							<table class="table  table-striped table-bordered" id="tablePayRoll">
							</table>
						</div>
					</div>
				</div>
			</div>	
		</div>
<!-- Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  			<div class="modal-dialog" role="document">
   				 <div class="modal-content">
      					<div class="modal-header">
        					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
          						<span aria-hidden="true">&times;</span>
   	     					</button>
        					<h4 class="modal-title" id="myModalLabel">New Company</h4>
      					</div>
      					<div class="modal-body">
      						<input type="text" class="form-control" placeholder="Company Name" id="cname"><br>
						<!--input type="text" class="form-control" placeholder="IT Month" id="citmonths"><br>
						<input type="text" class="form-control" placeholder="Shifts" id="cshifts"><br>
						<input type="text" class="form-control" placeholder="Paid Leave" id="f"><br>
						<input type="text" class="form-control" placeholder="Working Hours" id="g"><br>
						<input type="text" class="form-control" placeholder="Number of Departments" id="h"><br>
						<!-div id="ComapanyType">Type</div-->
      					</div>
      					<div class="modal-footer">
        					<button type="button" class="btn btn-secondary" data-dismiss="modal" id="newCompanyClose">Close</button>
        					<button type="button" class="btn btn-primary" id="btnCreateNew" >Save changes</button>
      					</div>
    				</div>
  			</div>
		</div>
        
	</body>
	<style>
		#panel{
			background-color:#f1f1f1;
			cursor: pointer;
		}
		#test{ 
			position: absolute;
			width: 100%;
			height: 100%;
			background-color:aqua;
		}
		#top{
			height:50px;
			background-color:#455a64;
			padding-left:5%;
			color: #fff;
			font-size: 30px;
			font-weight: bold;
		}
		#newTestOuter{
			padding-top:5%;
		}
		#quesplane{
			padding:2%;
		}
		#submitDiv{
			width:100%;
			text-align:center;
		}
		#btnSubmit{
			background-color:#00AE6D;
			text-transform: uppercase;
			outline: 0;
  			background: #4CAF50;
  			width: 100%;
  			border: 0;
  			padding: 15px;
  			color: #FFFFFF;
  			font-size: 14px;
  			-webkit-transition: all 0.3 ease;
  			transition: all 0.3 ease;
  			cursor: pointer;
			border-radius: 6px;
		}
		#btnNew{
			width:100%;	
		}
		#testHead{
			size:19px;
		}
		#modalNotification{
			width:100%;
			text-align:center;
		}
		#btnSubmit{
			width:300px;
		}
		#settings{
			position: static;
			float: right;
			font-size:20px;
			color:#666;
			cursor: pointer;
		}
		#settings:hover{
			color:#59F;
		}
		#btnCreateInAddSection{
			margin-top: 90px;
			margin-left: 45%;
		}
		.menu{
			position: static;
			float: right;
			margin-top: 7px;
			margin-right: 7px;
			}
		.add{
			position: static;
			float: right;
			font-size:20px;
			color:#666;
			cursor:pointer;
		}
		.add:hover{
			color:#59F;
		}
	</style>
	<script>
		var count=1;
		var th = $("#test").height();
		var toph = $("#top").height();
		$("#test").hide();
		$("#panel").height(th-toph);
		
			
		$(".nav-tabs li").on("click",function(){
			$(".nav-tabs li").removeClass("active");
			$(".section").hide();
			$("#"+$(this).attr("section")).show();
			$(this).addClass("active");
		});
		loadCompany();
		loadGeneral('{"Employees count":"100","Date of Next Payment":"1-12-2016"}');
		loadEmployees('[{"name":"sk","father name":"sekhar","DOB":"1-2-1996","Designation":"Director"},{"name":"none","father name":"nonedad","DOB":"1-4-1994","Designation":"Assistant"},{"name":"Mr X","father name":"Mr X dad","DOB":"1-2-2001","Designation":"Manager"}]');
		loadAddEmployees('[{"fields":"name"},{"fields":"fatherName"},{"fields":"Dob"},{"fields":"BasicPay"}]');
		function loadCompany() {
		    $.get("api/listcompanies", {}, function (result) {
		        // alert(result.message);
		        if (result.message != "Success") {
		            companyList =  ' <button type="button" class="list-group-item disabled">' + result.message + '</button> ';
		            $("#listTest").html(companyList);
		            return;
		        }
		        var obj = result.data;
		        var companyList="";
		        for( a in obj )
		            companyList = companyList + ' <button type="button" onclick="companyClick(this)" cid="' + obj[a].CompanyId + '" class="list-group-item">' + obj[a].CompanyName + '</button> ';
		        $("#listTest").html(companyList);
		    });
		}
		function loadGeneral(jsonGeneral) {
			var p = JSON.parse(jsonGeneral);
			s1 = "";
			for (var key in p ) {
				if (p.hasOwnProperty(key)){
					//console.log(key + " ->> " + p[key]); 
					s1 = s1 + "<tr> <td>" + key + "</td><td>" + p[key] + "</td></tr>";
				}
				$("#generalTable").html(s1);
			}
		}
		
		function loadEmployees(a){
			var p1 = JSON.parse(a);
			s1 = "";
			h1 = "<thead><tr>";
			for (i in p1 ){
				p = p1[i];
				s1 = s1 + "<tr>";
				for (var key in p ) {
					if (p.hasOwnProperty(key)){
						if ( i==0 ){
							h1 = h1 + "<th>" + key + "</th>";
						}
						//console.log(key + " ->> " + p[key]); 
						s1 = s1 + "<td>" + p[key] + "</td>";
					}
				}
				s1 = s1 + "</tr>";
			}
			h1 = h1 + "</tr></thead>";
			$("#empTable").html(h1 + s1);
		}
		var modalAddEmp ;
		function loadAddEmployees(a){
			var obj = JSON.parse(a);
			s = '<tr>';
			//alert(Object.keys(obj).length);
			modalAddEmp = obj;
			for ( i in obj ) {
				s = s + "<th>"+ obj[i].fields + "</th>";
			}
			s = s + "</tr>";
			$("#tableAddEmp").html(s);
		}

		$("#addNewEmpIcon").on("click",function(){
			s = '<tr>';
			obj = modalAddEmp;
			for ( i in obj ) {
				s = s + '<td><input type="text" id="'+ obj[i].fields+count+ '"placeholder="'+ obj[i].fields+' ' +count+ '"</td>';
			}	
			s = s + "</tr>";
			$("#tableAddEmp").append(s);
			count++;
		});
		$("#btnAddNewEmpDone").on("click", function () {
		    obj = modalAddEmp;
		    empAddDone = {}
		    j = 0;
		    alert("#" + obj[0].fields + "1");
		    if (document.getElementById("#" + obj[0].fields + "1")) {
		        alert("#" + obj[i].fields + count);
		        for (i in obj) {
		            empAddDone[j].obj.fields = $("#" + obj[i].fields + count).val();
		            j++;
		        }
		    }
		    alert(JSON.stringify(empAddDone));
		});
		$("#deleteEmpIcon").on("click",function(){
		
			if(count>1){
				//remove code
				//count--;
				}
			else {
				//alert("No Employees to remove");
				}
			
		});
		function companyClick(a) {
		    c = a.getAttribute("cid");
		    $.get("/api/employeeview", { token: getCookie("Token"),CompanyId: c }, function (result) {
		        // alert(result.message);
		        arr = result.data;
		        loadEmployees(JSON.stringify(arr));
		    });
		}
		function loadPayRoll(a){
			var p1 = JSON.parse(a);
			s1 = "";
			h1 = "<thead><tr>";
			for (i in p1 ){
				p = p1[i];
				s1 = s1 + "<tr>";
				for (var key in p ) {
					if (p.hasOwnProperty(key)){
						if ( i==0 ){
							h1 = h1 + "<th>" + key + "</th>";
						}
						//console.log(key + " ->> " + p[key]); 
						s1 = s1 + "<td>" + p[key] + "</td>";
					}
				}
				s1 = s1 + "</tr>";
			}
			h1 = h1 + "</tr></thead>";
			$("#tablePayRoll").html(h1 + s1);
		}
		$("#generalTab").trigger("click");
		$("#btnCreateNew").on("click", function () {
		    var name = $("#cname").val();
		    $.get("/api/addcompany", {token: getCookie("Token"), companyname: name}, function(result) {
		            notify(result.message);
		        
		    });
		});
		$("#signOut").on("click", function () {
		    deleteCookie();
		    //alert(getCookie("Token"));
		    window.location = "first.html";
		});
		$("#username").html(getCookie("Uname"));
		//validate();
        //alert($("#fsdfsdf"))

	</script>
	
</html>
